# First stage: complete build environment
FROM maven:3.5.0-jdk-8-alpine AS builder

# Add pom.xml and source code
COPY ./pom.xml pom.xml
COPY ./src src/

# Package jar
RUN mvn clean package

# Second Stage: Minimal Environment, Copy over needed Jar
FROM openjdk:11-jdk-slim

# Set the working directory
WORKDIR /app

# Copy the JAR file generated by your build tool
COPY --from=builder target/*.jar ./app.jar

# Expose the application's port
EXPOSE 5000

# Run the application
ENTRYPOINT ["java", "-jar", "/app/app.jar"]