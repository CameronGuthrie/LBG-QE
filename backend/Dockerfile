# First stage: complete build environment
FROM maven:3.9.0 AS builder

WORKDIR /build
# Add pom.xml and source code
COPY . .

# Package jar
RUN mvn clean package

# Second Stage: Minimal Environment, Copy over needed Jar
FROM openjdk:11-jdk-slim

# Set the working directory
WORKDIR /app

# Copy the JAR file generated by your build tool
COPY --from=builder ./target/banking-0.0.1-SNAPSHOT.jar ./app.jar

# Expose the application's port
EXPOSE 5000

# Run the application
ENTRYPOINT ["java", "-jar", "/app/app.jar"]